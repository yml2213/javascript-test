/*
é‚€è¯·ç :  003584319
æ„Ÿè°¢å¡«å†™! æ„Ÿè°¢å¡«å†™!! æ„Ÿè°¢å¡«å†™!!!
1.15 é˜…è¯»æ–‡ç« 
å¹³å°:   é’é¾™
è½¯ä»¶:  ä¸œæ–¹å¤´æ¡
æ”¶ç›Š:  10000é‡‘å¸=1å…ƒ
[Script]
cron "20 6-20 * * *" https://raw.githubusercontent.com/yml2213/javascript/master/dftt/dfttwz.js,tag=ä¸œæ–¹å¤´æ¡æ–‡ç« 

æ³¨æ„äº‹é¡¹ ï¼š ä¸€å®šè¦ä»”ç»†é˜…è¯»ä¸€ä¸‹å†…å®¹
=============é’é¾™å˜é‡æ ¼å¼=============
export dfttua=''
export dfttwzbd='params=XXXXX'
=============é’é¾™å˜é‡å®ä¾‹=============
export dfttua='Mozilla/5.0 (iPhone; CPU iPhone OS 12_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148'
export dfttwzbd='params=H0QHGzkHERoCAFZeRCAbKicMAh1HWEYWGwc2BwwMHEdORoPFxbvL+UFeRwAXRE5WbkVRUUBWQlZeTFZzUQQAEQwQRlxMTGhHV1JFUEJIRAAHAAAAEQQABkZcVlZzUQwQBQwSDUROVigaAwpQSVYICBNWZVFUUkRLTVJTQUFuQVVaR1ZDXERYVjwaERpQX1aC0/qR0uSA2/BHWEYXHRB9SUciAhUnEAkGEW1BVVJDUVZIRBcALFFfQUNTQFZUR0JtS11BXkcbF0ROVjYcFkFeRwcJIhECNhAAKhZHTkZUREZtQ1RSRldHVVFFQ2tFUlcRARAGVRZGbhBWVkJXTVwAQUE6RlwHQlJEXV8WRG5HXVAXB0MFB0QWOkdXW1BJVgUWBAU2F0dZUCQEFDUAGy0WV1FCVEVQRFhWLBwDFxwEGQFETlYbNTE3OyonRkpWGCtRX0EXLT42LURNLiQzJTsqMxBVJyMnGTYnOx8VHiwjIQoHHy03IwYwDSI+DkMJOyM9JhYEH00lKTJWCDMaFAcgIzc7Kzs3FzkjFkIiCiUsOh8/IjIgNQM6Ng4bKCEQBTVFNiYRDw8iBiAyVy48GTQxCBkSFjMFTSQOTlhBXkcaCwIRB31JRzgJOVYRFBgSLRwIP1BfKEYSGwErGgQMLkdYOEQADS8WOUFIOVYKAwMHA1FJP1AQBggSGyh9STlBGhEAFFwoKANcOT8uShlVSAAAcRALPy45WwkJFh0zFjk/LkpGVlZFRWpCUFJHVURcV0FaNwcIDy5HWDhEGhs7FjlBSFREGUoPKH0GFw8UFxsJOlZOA1ERDAcRHQUJKFZzL0cXCxUROEROKH0dABQBOVZIOlYBLR8RDC5HTjhEHAArA18/LjlbODooWzJCSxcGSxcKOigocB4KARsJETg6KFttQVVSQ1BFUVdBRG9LVFZcDQAJCihWcy9HDR0BEThETkZvDjhBXkcCARRWTn1BS1VcUFZIRBsRMlFfQTYjIDBEWFYrGggGADoAHRYRVmVRCwYFFisQDxkRLVFJQR0WKxIDBgc2HAtBSEcdKzVURWpdV0FeRxgFElZOfUBTTURRQlVeRkdqRlBaRlZNRkpWFS8DERoCAB0ARE5WGzUxN1BJVg0LEVZlUSRWMyFAVyRGWW02UCdfUTFWJFk2a0dcTkcnMFNeNzBmSlwnQ0dYRgUFHTtRX0EzFQQ3EhsGOlFJQRAEBwEVABUrGgoNUF9WChMYGH1fRwIcAQYLDxA9O1FfQUJVRFRWRERvXlVTQlVZVFZERHJDVVNCSERUVkREb0NVU0JVREZKVhA6BQwAF0dORg8kHDAdAFJGSUZGGw=='
=============å˜é‡è§£é‡Š==========
dfttua:UA è¿™ä¸ªä¸éœ€è¦è§£é‡Šäº†å§
dfttwzbd:å˜é‡ä¸­çš„xxxxæ˜¯ä½ çš„bodyåŒ…æ•°æ®,,å¯ä»¥ä» å…³é”®è¯ read_news åŒ…é‡Œæ‰¾åˆ°æ‰€æœ‰å˜é‡

=============å˜é‡è·å–==========
æ‡’å¾—å†™äº†ï¼Œè‡ªå·±ç ”ç©¶å§
ä¸ä¼šçš„è¯·ç™¾åº¦æˆ–è€…ç¾¤é‡Œæ±‚åŠ©ï¼šQQç¾¤ï¼š1001401060  tgï¼šç§‘æŠ€ç©å®¶@æˆ‘å³å¯

*/
// https://yuedu4.dftoutiao.com/index/Yuedutimer/read_news
const $ = new Env('ä¸œæ–¹å¤´æ¡æ–‡ç« ');
const host = 'yuedu4.dftoutiao.com';
const notify = $.isNode() ? require('./sendNotify') : '';
let dfttua = process.env.dfttua;
let body = process.env.dfttwzbd;
//==================================================è¿™é‡Œè‡ªå®šä¹‰é˜…è¯»æ–‡ç« æ•°é‡==================================================
let num = 30;   //é˜…è¯»æ•°é‡ï¼ˆé»˜è®¤30ï¼‰
//==================================================è¿™é‡Œè‡ªå®šä¹‰é˜…è¯»æ–‡ç« æ•°é‡==================================================
//å¼€å§‹è¿è¡Œ
!(async () => {
    console.log(`äº¤æµç¾¤:1001401060  by-yml`);
    await yml()

})()
    .catch((e) => $.logErr(e))
    .finally(() => $.done())

// https://yuedu4.dftoutiao.com/index/Yuedutimer/read_news
//è¿™é‡Œæ˜¯è¦æ‰§è¡Œçš„ä»£ç      ====== å¦‚æœæœ‰æ‚¨ä¸éœ€è¦çš„  è¯·è‡ªè¡Œæ³¨é‡Š  ä½¿ç”¨ // æ³¨é‡Šå°±è¡Œ ========
async function yml() {
    await wyy();
    for (let i = 0; i < num; i++) {
        if (i < num) {
            let u = i + 1;
            console.log(`æ­£åœ¨é˜…è¯»ç¬¬${u}ç¯‡,è¯·è€å¿ƒç­‰å¾…ï¼`);
            await wz();
        }
    }


//æ¯æ—¥ç½‘æŠ‘äº‘
    function wyy(timeout = 3 * 1000) {
        return new Promise((resolve) => {
            let url = {
                url: `https://keai.icu/apiwyy/api`
            }
            $.get(url, async (err, resp, data) => {
                try {
                    data = JSON.parse(data)
                    $.log(`\nã€ç½‘æŠ‘äº‘æ—¶é—´ã€‘: ${data.content}  by--${data.music}`);

                } catch (e) {
                    $.logErr(e, resp);
                } finally {
                    resolve()
                }
            }, timeout)
        })
    }


// https://yuedu4.dftoutiao.com/index/Yuedutimer/read_news
// é˜…è¯»æ–‡ç« ä»»åŠ¡
    function wz(timeout = 0) {
        return new Promise((resolve) => {
            let url = {
                url: `https://${host}/index/Yuedutimer/read_news`,
                headers: {
                    'User-Agent': dfttua
                },
                body: body
            }
            // console.log(url);
            $.post(url, async (err, resp, data) => {
                try {
                    // console.log(`è¾“å‡ºdataå¼€å§‹===================`);
                    // console.log(data);
                    // console.log(`è¾“å‡ºdataç»“æŸ===================`);

                    result = JSON.parse(data);
                    if (result.err_code == 0) {
                        $.log(`\nã€ğŸ‰ğŸ‰ğŸ‰ æ­å–œæ‚¨é¸­ ğŸ‰ğŸ‰ğŸ‰ã€‘é˜…è¯»æ–‡ç« : æˆåŠŸ âœ… äº†å‘¢ , è·å¾—é‡‘å¸${result.bonus}æš!ï¼`)
                        await $.wait(60 * 1000);
                    } else {
                        $.log(`\nã€ğŸ‰ æ­å–œä¸ªå± ğŸ‰ã€‘é˜…è¯»æ–‡ç« :å¤±è´¥ âŒ äº†å‘¢,åŸå› å¯èƒ½æ˜¯æ˜¯:${result.msg}`)
                        await $.wait(5 * 1000);

                    }
                } catch (e) {
                    $.logErr(e, resp);
                } finally {
                    resolve()
                }
            }, timeout)

        })


    }
}




